[{"fullname": "main", "modulename": "main", "qualname": "", "type": "module", "doc": "<h1 id=\"salt-and-pepper-demo\"><strong>Salt and pepper demo</strong></h1>\n\n<p>This is a demo of how salt and pepper work in a theoretical aspect, and is intended for educational purposes. PLEASE DO NOT USE IN PRODUCTION</p>\n\n<hr />\n\n<h2 id=\"why\"><strong>Why</strong></h2>\n\n<p>The question everyone will ask at some point, salt and pepper is indented to address the short comings of storing hashed passwords in a database. What are the aforementioned short comings? Let\u2019s say we are using authentication model without salt or pepper in place and two users have the same passwords, in the event a hacker gets access to the database the hacker can see who has the same password making it more effective for a hacker to crack one hash and get access to anyone with the same password.</p>\n\n<h2 id=\"avalanche-effect\"><strong>Avalanche effect</strong></h2>\n\n<p>The avalanche effect is one of the most desirable effects in cryptography. The avalanche effect is simply put; if you change one single bit in the plain text it snowballs and changes the output of the hash entirely. Cool right? that means if I change the \"A\" in Andrew to \"a\" I get a different hash. Remember this as the concept will get taken to the extreme with salts.</p>\n\n<h2 id=\"salt\"><strong>Salt</strong></h2>\n\n<p>The process of salting a password is fairly simple it's just adding a random sequence of bits to the plain text which subsequently triggers the avalanche effect from earlier. One downside is the salt typically gets stored in the database with the hash, so in the event a hacker gets access to the database they will have the salt to attempt a rainbow table attack. The next concept we will cover will help prevent this.</p>\n\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">def</span> <span class=\"nf\">salt_generator</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"nb\">str</span><span class=\"p\">:</span>\n    <span class=\"n\">salt</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;&#39;</span>\n    <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">64</span><span class=\"p\">):</span>\n        <span class=\"n\">salt</span> <span class=\"o\">+=</span> <span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">choice</span><span class=\"p\">(</span><span class=\"n\">string</span><span class=\"o\">.</span><span class=\"n\">ascii_letters</span><span class=\"o\">+</span><span class=\"n\">string</span><span class=\"o\">.</span><span class=\"n\">digits</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">salt</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p>Here is an example of how you would generate a salt for a user, this one makes a salt string of 64 characters making for a possible 9.6196304190416 x 10^111 combinations.</p>\n\n<pre><code>96 1963041904 1620901435 3125244491 2446413079 5720328478 1904170638 1939592816 6869436184 4273110973 8401260761 8805661696\n</code></pre>\n\n<h2 id=\"pepper\"><strong>Pepper</strong></h2>\n\n<p>If salt is adding randomness to a password what is pepper then? Pepper is adding a reversible hidden randomness to a password, emphasis on hidden as it's not stored with the salt or on a database, there are 3 types of salt each offering a different level of security with its own trade-offs, if you are wondering what they are is \"Shared Secret Pepper\", \"Unique Pepper Per User\" and \"Randomly Selected Pepper\". For this demo I have selected to use the \"Shared Secret Pepper\" to keep the concept ease for everyone to understand.</p>\n\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">def</span> <span class=\"nf\">pepper</span><span class=\"p\">(</span><span class=\"n\">password</span><span class=\"p\">:</span><span class=\"nb\">str</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"nb\">str</span><span class=\"p\">:</span>\n    <span class=\"n\">password</span> <span class=\"o\">=</span> <span class=\"n\">password</span><span class=\"p\">[::</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"k\">return</span> <span class=\"n\">password</span>\n</code></pre></div>\n\n<p>In this example I have a simple little algorithm the just reverses the string I.E. \"Hello\" gets turned into \"elloH\" thats it. But this alone will trigger the avalanche effect.</p>\n\n<h2 id=\"python-code-examples\"><strong>Python code examples</strong></h2>\n\n<p>How do we add a password to a database with salt and pepper</p>\n\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nd\">@database_creation</span>\n<span class=\"k\">def</span> <span class=\"nf\">database_add_user_salt_and_pepper</span><span class=\"p\">(</span><span class=\"n\">username</span><span class=\"p\">:</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">password</span><span class=\"p\">:</span><span class=\"nb\">str</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"kc\">None</span><span class=\"p\">:</span>\n    <span class=\"n\">salt</span> <span class=\"o\">=</span> <span class=\"n\">salt_generator</span><span class=\"p\">()</span>\n    <span class=\"n\">password</span> <span class=\"o\">=</span> <span class=\"n\">pepper</span><span class=\"p\">(</span><span class=\"n\">password</span><span class=\"p\">)</span>\n    <span class=\"n\">password</span> <span class=\"o\">=</span> <span class=\"n\">password</span> <span class=\"o\">+</span> <span class=\"n\">salt</span>\n    <span class=\"n\">password</span> <span class=\"o\">=</span> <span class=\"n\">hash_password</span><span class=\"p\">(</span><span class=\"n\">password</span><span class=\"p\">)</span>\n    <span class=\"k\">with</span> <span class=\"n\">connection_to_database</span><span class=\"p\">:</span>\n        <span class=\"n\">database_cursor</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span>\n            <span class=\"s1\">&#39;INSERT INTO passwords VALUES (:username, :password, :salt)&#39;</span><span class=\"p\">,</span> \n            <span class=\"p\">{</span><span class=\"s1\">&#39;username&#39;</span><span class=\"p\">:</span> <span class=\"n\">username</span><span class=\"p\">,</span> <span class=\"s1\">&#39;password&#39;</span><span class=\"p\">:</span> <span class=\"n\">password</span><span class=\"p\">,</span> <span class=\"s2\">&quot;salt&quot;</span><span class=\"p\">:</span> <span class=\"n\">salt</span><span class=\"p\">})</span>\n</code></pre></div>\n\n<p>How do we check if a password equals the stored hash?.</p>\n\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">def</span> <span class=\"nf\">salt_hash_check</span><span class=\"p\">(</span><span class=\"n\">password</span><span class=\"p\">:</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">database_hash</span><span class=\"p\">:</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">database_salt</span><span class=\"p\">:</span><span class=\"nb\">str</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"nb\">bool</span><span class=\"p\">:</span>\n    <span class=\"n\">password</span> <span class=\"o\">=</span> <span class=\"n\">pepper</span><span class=\"p\">(</span><span class=\"n\">password</span><span class=\"p\">)</span>\n    <span class=\"n\">password</span> <span class=\"o\">=</span> <span class=\"n\">hash_password</span><span class=\"p\">(</span><span class=\"n\">password</span> <span class=\"o\">+</span> <span class=\"n\">database_salt</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">password</span> <span class=\"o\">==</span> <span class=\"n\">database_hash</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"kc\">True</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"kc\">False</span>\n</code></pre></div>\n"}, {"fullname": "main.main", "modulename": "main", "qualname": "main", "type": "function", "doc": "<p>Dispaly system</p>\n", "parameters": [], "funcdef": "def"}, {"fullname": "main.clear_terminal", "modulename": "main", "qualname": "clear_terminal", "type": "function", "doc": "<p>Clears the terminal for a clean output</p>\n", "parameters": [], "funcdef": "def"}, {"fullname": "main.option_check", "modulename": "main", "qualname": "option_check", "type": "function", "doc": "<p>Menu system</p>\n", "parameters": ["option"], "funcdef": "def"}, {"fullname": "main.login", "modulename": "main", "qualname": "login", "type": "function", "doc": "<p>Front end login system</p>\n", "parameters": ["username", "password"], "funcdef": "def"}]